# -*- coding: utf-8 -*-
"""Join Datasets.ipynb

Automatically generated by Colaboratory.

Original file is located at
    https://colab.research.google.com/drive/1SOlnGHWgzpo4tL-m7Cin9qJfCsFiyc_4
"""

import pandas as pd
from google.colab import files, drive

drive.mount('/content/gdrive')
root_path = f'/content/gdrive/My Drive/Capstone Public Folder/Notebooks-DamageAlg/'

df1 =  pd.read_csv(root_path + "Tree Cover/Final Tree Cover CSV/final_tree_cover.csv.gz", compression = 'gzip')
df2 =  pd.read_csv(root_path + "ProtectedAreas/normalized_PA_log.csv.gz", compression = 'gzip')
display(df1.head())
print("df1 length: "+ str(len(df1)))
df2.drop(columns=['PA_COUNT'],inplace=True)
df2.rename(columns={"KEY": "LOCATION_KEY"},inplace=True)
display(df2.head())
print("df2 length: "+ str(len(df2)))
df3 = df1.join(df2.set_index('LOCATION_KEY'), on='LOCATION_KEY')
display(df3.head())
print("df3 length: "+ str(len(df3)))

print("Saving as CSV...")
df3.to_csv(root_path + "/Joined Dataset/joined_dataset.csv.gz", compression= 'gzip', index = False)
print("Done!")

